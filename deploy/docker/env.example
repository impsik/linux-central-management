# Same as .env.example, but without a leading dot (some systems hide dotfiles).
# Copy to .env and fill values

# UI bootstrap admin user (created on first run if not exists)
BOOTSTRAP_USERNAME=admin
BOOTSTRAP_PASSWORD=change-me-long-random

# Cookie security (set true behind HTTPS)
# If you run behind an HTTPS reverse proxy, set this to true.
UI_COOKIE_SECURE=false
# Set true only if you explicitly want every server restart to force all users to log in again.
UI_REVOKE_ALL_SESSIONS_ON_STARTUP=false

# Optional CSP override (advanced): leave unset to use built-in nonce-based policy.
# CONTENT_SECURITY_POLICY=default-src 'self'; script-src 'self' https://cdn.jsdelivr.net; style-src 'self' https://cdn.jsdelivr.net 'unsafe-inline'; img-src 'self' data:; font-src 'self' https://cdn.jsdelivr.net data:; connect-src 'self' ws: wss:; object-src 'none'; frame-ancestors 'none'; base-uri 'self'

# Optional HTTPS reverse proxy settings (Caddy example)
# FLEET_DOMAIN=fleet.example.com
# FLEET_UPSTREAM=server:8000
# CADDY_EMAIL=you@example.com

# MFA (TOTP) - required for admin/operator by default
# Generate a key:
#   python3 -c "from cryptography.fernet import Fernet; print(Fernet.generate_key().decode())"
MFA_ENCRYPTION_KEY=
MFA_REQUIRE_FOR_PRIVILEGED=true
MFA_TOTP_ISSUER=linux-central-management

# Database schema management
# In production, set DB_AUTO_CREATE_TABLES=false and deploy with:
#   docker compose exec server alembic upgrade head
DB_AUTO_CREATE_TABLES=true
DB_REQUIRE_MIGRATIONS_UP_TO_DATE=true

# Optional override: allow admin-triggered migrations endpoint (keep false in prod)
ADMIN_ENABLE_MIGRATIONS_ENDPOINT=false

# Agent auth tokens (shared secret MVP)
AGENT_SHARED_TOKEN=change-me-agent-token
# Terminal proxy token (server-side). Must match the agent-side token (FLEET_TERMINAL_TOKEN).
AGENT_TERMINAL_TOKEN=change-me-terminal-token
# Use wss in production when running behind HTTPS reverse proxy.
AGENT_TERMINAL_SCHEME=ws

# Optional: used by docker-compose to mount SSH keys for in-container Ansible.
# SSH_DIR=/home/youruser/.ssh

# Postgres is internal-only by default (not published to host).
# For local debugging, publish via a compose override, e.g.:
#   services:
#     db:
#       ports:
#         - "127.0.0.1:5432:5432"

# Database (optional override)
# DATABASE_URL=postgresql+psycopg://fleet:fleet@db:5432/fleet

# Teams alerts (optional)
# Create an Incoming Webhook in Teams channel and paste URL here.
TEAMS_WEBHOOK_URL=
TEAMS_ALERTS_ENABLED=false

# Notification center backend dedupe/cooldown
NOTIFICATIONS_DEDUPE_ENABLED=true
NOTIFICATIONS_DEDUPE_COOLDOWN_SECONDS=1800

# Maintenance window guardrails (optional)
# If enabled, guarded actions are blocked outside this local window.
MAINTENANCE_WINDOW_ENABLED=false
MAINTENANCE_WINDOW_TIMEZONE=UTC
MAINTENANCE_WINDOW_START_HHMM=01:00
MAINTENANCE_WINDOW_END_HHMM=05:00
MAINTENANCE_WINDOW_GUARDED_ACTIONS=dist-upgrade,security-campaign

# Two-person approval workflow for high-risk actions
HIGH_RISK_APPROVAL_ENABLED=false
HIGH_RISK_APPROVAL_ACTIONS=dist-upgrade,security-campaign
